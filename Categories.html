<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Buy Books - Sofitra</title>
  <link rel="stylesheet" href="styles.css">
  <style>
    /* Shared Styles */
    body {
      background-color: beige;
      color: brown;
      font-family: Arial, sans-serif;
    }

    h1,
    h2,
    h3 {
      text-align: center;
      color: brown;
    }

    /* Navigation Bar */
    nav {
      text-align: center;
      margin: 20px 0;
      padding: 10px;
      background-color: #fdf5e6;
      border-bottom: 2px solid brown;
    }

    a.button {
      background: brown;
      color: beige;
      padding: 10px 20px;
      border-radius: 5px;
      display: inline-block;
      font-weight: bold;
      margin: 5px;
      text-align: center;
      text-decoration: none;
      transition: background 0.3s;
    }

    a.button:hover {
      background: #5c3d2e;
    }

    /* Form & Controls */
    select,
    button {
      padding: 8px;
      margin: 5px;
      border: 1px solid brown;
      border-radius: 4px;
      background-color: #fff;
      color: brown;
    }

    button {
      background-color: brown;
      color: beige;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover {
      background-color: #5c3d2e;
    }

    /* Book List Grid */
    #book-list {
      max-width: 900px;
      margin: 30px auto;
      padding: 20px;
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      /* Grid layout */
      gap: 20px;
      justify-content: center;
    }

    .book-item {
      padding: 15px;
      background-color: #fff8e1;
      border: 1px solid brown;
      border-radius: 8px;
      cursor: pointer;
      text-align: center;
      transition: transform 0.2s, box-shadow 0.2s;
      display: flex;
      flex-direction: column;
      align-items: center;
      height: 100%;
    }

    .book-item:hover {
      transform: translateY(-5px);
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
    }

    .book-item img {
      width: 120px;
      /* Smaller fixed width */
      height: 180px;
      /* Fixed height */
      object-fit: cover;
      border-radius: 4px;
      margin-bottom: 10px;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
    }

    .book-title {
      font-weight: bold;
      margin-bottom: 5px;
      font-size: 1.1em;
    }

    .book-meta {
      font-size: 0.9em;
      color: #666;
    }

    /* Modal */
    #book-modal {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: #fdf5e6;
      border: 2px solid brown;
      padding: 25px;
      z-index: 1000;
      width: 320px;
      border-radius: 8px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
      text-align: center;
    }

    #modal-image {
      width: 140px;
      height: 210px;
      object-fit: cover;
      border-radius: 6px;
      margin: 10px auto;
      display: block;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
    }

    #overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(92, 61, 46, 0.6);
      /* Brownish tint */
      z-index: 900;
      backdrop-filter: blur(2px);
    }

    #cart {
      max-width: 600px;
      margin: 20px auto;
      padding: 15px;
      background-color: #fdf5e6;
      border: 1px solid brown;
      border-radius: 8px;
    }

    /* Filter Form Specific Styles (Horizontal Layout) */
    #filter-form {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      gap: 15px;
      max-width: 800px;
      margin: 20px auto;
    }

    #filter-form label,
    #filter-form select,
    #filter-form button {
      width: auto;
      margin: 0;
    }
  </style>
</head>

<body>

  <nav>
    <a href="home.php" class="button">← Back to Home</a>
    <a href="index.html" class="button">Log Out</a>
  </nav>

  <h1>Available Books</h1>

  <form id="filter-form">
    <label for="category">Choose Category:</label>
    <select id="category">
      <option value="">-- All Categories --</option>
      <option value="Novels">Novels</option>
      <option value="Philosophy">Philosophy</option>
      <option value="Comics">Comics</option>
    </select>

    <label for="price">Choose Price:</label>
    <select id="price">
      <option value="">-- All Prices --</option>
      <option value="low">Under 30 SAR</option>
      <option value="medium">30 - 100 SAR</option>
      <option value="high">Above 100 SAR</option>
    </select>

    <button type="submit">Filter Books</button>
    <button type="button" id="reset">Reset</button>
  </form>


  <div id="book-list"></div>


  <div id="overlay"></div>
  <div id="book-modal">
    <h3 id="modal-title"></h3>
    <img id="modal-image" src="" alt="Book cover" style="width:100%; border-radius:8px;">
    <p id="modal-category"></p>
    <p id="modal-price"></p>
    <p id="modal-author"></p>
    <p id="modal-description"></p>
    <button id="add-to-cart">Add to Cart</button>
    <button onclick="closeModal()">Close</button>
  </div>


  <div id="cart">
    <h2>Your Cart</h2>
    <ul id="cart-items"></ul>
  </div>

  <script>
    const books = [
      {
        title: "Crime and Punishment",
        category: "Novels",
        price: 55,
        author: "Fyodor Dostoevsky",
        description: "A psychological novel exploring guilt, morality, and redemption through the story of a man who commits a crime.",
        image: "photo/Crime.png"
      },
      {
        title: "Sophie's World",
        category: "Philosophy",
        price: 48,
        author: "Jostein Gaarder",
        description: "An engaging introduction to philosophy told through the story of a young girl receiving mysterious letters.",
        image: "photo/sophie.jpg"
      },
      {
        title: "Kafka on the Shore",
        category: "Novels",
        price: 62,
        author: "Haruki Murakami",
        description: "A surreal journey blending dreams, memory, and reality in a story of self-discovery.",
        image: "photo/kafka.jpg"
      },
      {
        title: "The Philosophy of Calmness",
        category: "Philosophy",
        price: 35,
        author: "Marcus Aurelius",
        description: "A collection of thoughts on maintaining inner peace and wisdom in everyday life.",
        image: "photo/calmness.jpg"
      },
      {
        title: "Bleach (Manga)",
        category: "Comics",
        price: 40,
        author: "Tite Kubo",
        description: "A Japanese manga following Ichigo Kurosaki’s journey after gaining the powers of a Soul Reaper.",
        image: "photo/bleach.jpg"
      }
    ];

    const categorySelect = document.getElementById('category');
    const priceSelect = document.getElementById('price');
    const bookList = document.getElementById('book-list');
    const form = document.getElementById('filter-form');
    const resetBtn = document.getElementById('reset');
    const modal = document.getElementById('book-modal');
    const overlay = document.getElementById('overlay');
    const modalTitle = document.getElementById('modal-title');
    const modalCategory = document.getElementById('modal-category');
    const modalPrice = document.getElementById('modal-price');
    const addToCartBtn = document.getElementById('add-to-cart');
    const cartItems = document.getElementById('cart-items');

    let selectedBook = null;
    let cart = [];

    function showBooks(list) {
      bookList.innerHTML = '';

      if (list.length === 0) {
        bookList.innerHTML += '<p>No books found.</p>';
        return;
      }

      for (let book of list) {
        let item = document.createElement('div');
        item.className = 'book-item';

        // Create image element
        let img = document.createElement('img');
        img.src = book.image;
        img.alt = book.title;

        // Create title element
        let title = document.createElement('div');
        title.className = 'book-title';
        title.textContent = book.title;

        // Create meta info element
        let meta = document.createElement('div');
        meta.className = 'book-meta';
        meta.textContent = `${book.category} - ${book.price} SAR`;

        item.appendChild(img);
        item.appendChild(title);
        item.appendChild(meta);

        item.onclick = function () {
          showDetails(book);
        };
        bookList.appendChild(item);
      }
    }

    function showDetails(book) {
      selectedBook = book;
      modalTitle.textContent = book.title;
      modalCategory.textContent = "Category: " + book.category;
      modalPrice.textContent = "Price: " + book.price + " SAR";
      document.getElementById('modal-author').textContent = "Author: " + book.author;
      document.getElementById('modal-description').textContent = book.description;
      document.getElementById('modal-image').src = book.image;
      modal.style.display = 'block';
      overlay.style.display = 'block';
    }

    function closeModal() {
      modal.style.display = 'none';
      overlay.style.display = 'none';
    }

    addToCartBtn.onclick = function () {
      if (selectedBook) {
        cart.push(selectedBook);
        updateCart();
        closeModal();
        const goBtn = document.createElement('button');
        goBtn.textContent = "Go to Payment";
        goBtn.onclick = function () {
          window.location.href = "payment.html";
        };

        const cartDiv = document.getElementById('cart');
        if (!document.getElementById('goPaymentBtn')) {
          goBtn.id = 'goPaymentBtn';
          goBtn.style.marginTop = "15px";
          cartDiv.appendChild(goBtn);
        }
      }
    };

    function updateCart() {
      cartItems.innerHTML = '';
      cart.forEach(item => {
        const li = document.createElement('li');
        li.textContent = item.title + " - " + item.price + " SAR";
        cartItems.appendChild(li);
      });
    }

    function filterBooks() {
      const category = categorySelect.value;
      const price = priceSelect.value;

      const filtered = books.filter(book => {
        const matchCategory = !category || book.category === category;
        const matchPrice =
          !price ||
          (price === 'low' && book.price < 30) ||
          (price === 'medium' && book.price >= 30 && book.price <= 100) ||
          (price === 'high' && book.price > 100);

        return matchCategory && matchPrice;
      });

      showBooks(filtered);
    }

    form.addEventListener('submit', function (event) {
      event.preventDefault();
      filterBooks();
    });

    resetBtn.addEventListener('click', function () {
      categorySelect.value = '';
      priceSelect.value = '';
      showBooks(books);
    });

    window.addEventListener('load', function () {
      showBooks(books);
    });
  </script>

</body>

</html>